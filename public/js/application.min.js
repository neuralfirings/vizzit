console.log("r1"),$(document).ready(function(){return $(".chart").attr("width",$("#charts-container").width()+"px"),$("#vizzit").click(function(){var e,t,a,r,n,o,i,l;return l=$("#subreddit").val(),n=$("#searchstring").val(),a=$("#numthreads").val(),$("#ajax_progress_container").show(),o="https://www.reddit.com/"+l+"/search.json?q="+n+"&restrict_sr=on&limit="+a,$.ajax(o).done(function(e){var t,a,n,o,i,s,h,d,c;for(a=e,t=a.data.children.length,d=a.data.children,c=[],s=0,h=d.length;h>s;s++)n=d[s],o="https://www.reddit.com/"+l+"/comments/"+n.data.id,i=[],c.push($.ajax(o+".json").done(function(e){var a;return i.push(e),a=Math.ceil(i.length/t*100),$("#ajax_progress").find(".progress-bar ").attr("aria-valuenow",a).css("width",a+"%").html(a+"%"),i.length===t?(r(i),setTimeout(function(){return $("#ajax_progress_container").fadeOut()},750)):void 0}));return c}),e="",t=[],$.all_comments={},r=function(a){var r,n,o,s,h,d,c,g,u,m,p,w,b,y,f,v,_,k,x,j,C,q,z,A,B,F,E,K,S,L,M,O,R,T,D,G,H,I,J,N,P,Q,U;for(S=0,R=a.length;R>S;S++)for(j=a[S],z=j[0].data.children[0].data.title,C=j[0].data.children[0].data.id,q=j[1].data,A=j[0].data.children[0].data.url,U=q.children,L=0,T=U.length;T>L;L++)o=U[L],e+=o.data.body+" ",n=o.data.replies?o.data.replies.data.children.length:0,s="https://www.reddit.com/"+l+"/comments/"+C+"/vizzit/"+o.data.id,t.push([o.data.score,o.data.body,n,s,z,A]);if(e=e.toLowerCase(),K=e.split(/\b/),F={},E={},b=[" ","the",",","i","to","a",".","and","'","/","of","it","you","in","is","that","with",", ","for","my","be","this","have","but","://","com","are","on","s","would","http","if","-","can",".↵↵","at","as","t","want","(","will","out","not","m","an","get","about","what","one","from","we","they","just","your","use","it","all","www","ve","do","!","more","so","like","good","make","has","me","or","=","](",")","if","here","was","0","some","am",": ","time","been"," $",";","really","also","by","there","[","","!",". ",":","?","$","love","something","could","now","people","amp",").","very","ll","great","only","&","them","their","any","think","even","its","much","imgur","using","when","don","had","work","these","community","d","into","see","our","best","well","way","going","though","able","new","because","better","who","which","things","quality","few","probably","than","own","should","first","sure","looking","say","re","no","%","doing","buy","https","products","tool","works","service","ever","board","user","told","free","try","lots","helpful","paying","wouldn","tinkering","machine","thing","budget","hobby","spending","different","story","many","-$","price","output","however","required","maybe","worth","wait","machines","come","still","aren","reviews","yet","expecting","over","models","let","begin","recently","/)","happy","around","while","pretty","support","why","seeing","little","talk","market","looks","option","consider","everyone","recommend","personally","received","easy","access","pcb","heated","bed","type","success","shop","black","assembled","hate","believe","html","absolutely","amazing","large","purchase","imho","then","...","made","*","awesome","across","day","printing",".(","getting","anything","lot","money","expenses","although","camera","need","8","run","back","order","three","...[","deleted","]","definitely","casting","afford","injection","molding","setup","1","2","3","4","5","6","7","8","9","0","q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m","he","co","en","de","us","ht","hi","im","ee","ge"],""===$("#limitwords").val())for(f=[],M=0,D=K.length;D>M;M++)B=K[M],_=B.replace(/\ /g,"").replace(/(\r\n|\n|\r)/gm,""),-1===$.inArray(_,b)&&-1===$.inArray(_,f)&&("x"===_&&console.log(_,B),f.push(_));else f=$("#limitwords").val().replace(", ",",").split(",");for(O=0,G=f.length;G>O;O++)for(y=f[O],N=0,H=t.length;H>N;N++)o=t[N],o[1].split(y).length>1&&(void 0===$.all_comments[y]&&($.all_comments[y]=[]),$.all_comments[y].push(o),o[0]>0&&(E["_"+y]=(E["_"+y]||0)+o[0]),F["_"+y]=(F["_"+y]||0)+1);k=[],x=[];for(B in F)F[B]>1&&k.push([B.replace("_",""),F[B]]);for(B in E)E[B]>1&&x.push([B.replace("_",""),E[B]]);for(k.sort(function(e,t){return t[1]-e[1]}),x.sort(function(e,t){return t[1]-e[1]}),g=[],u=[],P=0,I=k.length;I>P;P++)v=k[P],g.push(v[0]),u.push(v[1]);for(p=[],w=[],Q=0,J=x.length;J>Q;Q++)v=x[Q],p.push(v[0]),w.push(v[1]);return r=50,void 0!==$.chart_weighted&&$.chart_weighted.destroy(),d=$("#chart_weighted").get(0).getContext("2d"),m={labels:p.slice(0,r),datasets:[{label:"Keyword Frequency",fillColor:"rgba(220,180,90,0.5)",strokeColor:"rgba(220,180,90,0.5)",highlightFill:"rgba(220,180,90,0.5)",highlightStroke:"rgba(220,180,90,0.5)",data:w.slice(0,r)}]},$.chart_weighted=new Chart(d).Bar(m),$("#chart_weighted").click(function(e){var t,a;return t=$.chart_weighted.getBarsAtEvent(e),a=t[0].label,i(a)}),void 0!==$.chart_unweighted&&$.chart_unweighted.destroy(),h=$("#chart_unweighted").get(0).getContext("2d"),c={labels:g.slice(0,r),datasets:[{label:"Keyword Frequency",fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:u.slice(0,r)}]},$.chart_unweighted=new Chart(h).Bar(c),$("#chart_unweighted").click(function(e){var t,a;return t=$.chart_unweighted.getBarsAtEvent(e),a=t[0].label,i(a)})},i=function(e){var t,a,r,n,o;for(a=$.all_comments[e],$("#commentviewer").empty(),o=[],r=0,n=a.length;n>r;r++)t=a[r],o.push($("#commentviewer").append("<div class='comment'> <span class='badge'>"+t[0]+" points</span>&nbsp;<a target='_blank' href='"+t[5]+"'>"+t[4]+"</a><br />"+t[1].replace(new RegExp("(^|)("+e+")(|$)","ig"),'$1<span class="search-kw text-danger">$2</span>$3')+"<br /><small>["+t[2]+" replies |  <a target='_blank' href='"+t[3]+"'>permalink</a>]</small></div><hr />"));return o}})});
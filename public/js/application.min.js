var getUrlParameter,showComments;console.log("r2"),$(document).ready(function(){var e,t,r,a,n,o,l,i,s,h,d,c;return l=getUrlParameter("sr"),n=getUrlParameter("nt"),o=getUrlParameter("ss"),a=getUrlParameter("lw"),e=50,$(".chart").attr("width",$("#charts-container").width()+"px"),l&&n&&o&&a?($("#subreddit").val(l),$("#searchstring").val(o),$("#limitwords").val(a),$("#numthreads").val(n),c=$("#subreddit").val(),h=$("#searchstring").val(),i=$("#numthreads").val(),$("#ajax_progress_container").show(),d="https://www.reddit.com/"+c+"/search.json?q="+h+"&restrict_sr=on&limit="+i,$.ajax(d).done(function(e){var t,r,a,n,o,l,i,h,d;for(r=e,t=r.data.children.length,h=r.data.children,d=[],l=0,i=h.length;i>l;l++)a=h[l],n="https://www.reddit.com/"+c+"/comments/"+a.data.id,o=[],d.push($.ajax(n+".json").done(function(e){var r;return o.push(e),r=Math.ceil(o.length/t*100),$("#ajax_progress").find(".progress-bar ").attr("aria-valuenow",r).css("width",r+"%").html(r+"%"),o.length===t?(s(o),setTimeout(function(){return $("#ajax_progress_container").fadeOut()},750)):void 0}));return d}),t="",r=[],$.all_comments={},s=function(a){var n,o,l,i,s,h,d,g,u,m,p,w,b,y,f,v,_,k,x,C,j,U,q,P,z,A,B,F,E,K,R,S,I,L,M,O,T,D,G,H,J,N;for(F=0,S=a.length;S>F;F++)for(x=a[F],U=x[0].data.children[0].data.title,C=x[0].data.children[0].data.id,j=x[1].data,q=x[0].data.children[0].data.url,N=j.children,E=0,I=N.length;I>E;E++)o=N[E],t+=o.data.body+" ",n=o.data.replies?o.data.replies.data.children.length:0,l="https://www.reddit.com/"+c+"/comments/"+C+"/vizzit/"+o.data.id,r.push([o.data.score,o.data.body,n,l,U,q]);if(t=t.toLowerCase(),B=t.split(/\b/),z={},A={},w=[" ","the",",","i","to","a",".","and","'","/","of","it","you","in","is","that","with",", ","for","my","be","this","have","but","://","com","are","on","s","would","http","if","-","can",".↵↵","at","as","t","want","(","will","out","not","m","an","get","about","what","one","from","we","they","just","your","use","it","all","www","ve","do","!","more","so","like","good","make","has","me","or","=","](",")","if","here","was","0","some","am",": ","time","been"," $",";","really","also","by","there","[","","!",". ",":","?","$","love","something","could","now","people","amp",").","very","ll","great","only","&","them","their","any","think","even","its","much","imgur","using","when","don","had","work","these","community","d","into","see","our","best","well","way","going","though","able","new","because","better","who","which","things","quality","few","probably","than","own","should","first","sure","looking","say","re","no","%","doing","buy","https","products","tool","works","service","ever","board","user","told","free","try","lots","helpful","paying","wouldn","tinkering","machine","thing","budget","hobby","spending","different","story","many","-$","price","output","however","required","maybe","worth","wait","machines","come","still","aren","reviews","yet","expecting","over","models","let","begin","recently","/)","happy","around","while","pretty","support","why","seeing","little","talk","market","looks","option","consider","everyone","recommend","personally","received","easy","access","pcb","heated","bed","type","success","shop","black","assembled","hate","believe","html","absolutely","amazing","large","purchase","imho","then","...","made","*","awesome","across","day","printing",".(","getting","anything","lot","money","expenses","although","camera","need","8","run","back","order","three","...[","deleted","]","definitely","casting","afford","injection","molding","setup","1","2","3","4","5","6","7","8","9","0","q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m","he","co","en","de","us","ht","hi","im","ee","ge"],""===$("#limitwords").val())for(y=[],K=0,L=B.length;L>K;K++)P=B[K],v=P.replace(/\ /g,"").replace(/(\r\n|\n|\r)/gm,""),-1===$.inArray(v,w)&&-1===$.inArray(v,y)&&("x"===v&&console.log(v,P),y.push(v));else y=$("#limitwords").val().replace(", ",",").split(",");for(R=0,M=y.length;M>R;R++)for(b=y[R],G=0,O=r.length;O>G;G++)o=r[G],o[1].split(b).length>1&&(void 0===$.all_comments[b]&&($.all_comments[b]=[]),$.all_comments[b].push(o),o[0]>0&&(A["_"+b]=(A["_"+b]||0)+o[0]),z["_"+b]=(z["_"+b]||0)+1);_=[],k=[];for(P in z)z[P]>1&&_.push([P.replace("_",""),z[P]]);for(P in A)A[P]>1&&k.push([P.replace("_",""),A[P]]);for(_.sort(function(e,t){return t[1]-e[1]}),k.sort(function(e,t){return t[1]-e[1]}),d=[],g=[],H=0,T=_.length;T>H;H++)f=_[H],d.push(f[0]),g.push(f[1]);for(m=[],p=[],J=0,D=k.length;D>J;J++)f=k[J],m.push(f[0]),p.push(f[1]);return void 0!==$.chart_weighted&&$.chart_weighted.destroy(),s=$("#chart_weighted").get(0).getContext("2d"),u={labels:m.slice(0,e),datasets:[{label:"Keyword Frequency",fillColor:"rgba(220,180,90,0.5)",strokeColor:"rgba(220,180,90,0.5)",highlightFill:"rgba(220,180,90,0.5)",highlightStroke:"rgba(220,180,90,0.5)",data:p.slice(0,e)}]},$.chart_weighted=new Chart(s).Bar(u),$("#chart_weighted").click(function(e){var t,r;return t=$.chart_weighted.getBarsAtEvent(e),r=t[0].label,showComments(r)}),void 0!==$.chart_unweighted&&$.chart_unweighted.destroy(),i=$("#chart_unweighted").get(0).getContext("2d"),h={labels:d.slice(0,e),datasets:[{label:"Keyword Frequency",fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:g.slice(0,e)}]},$.chart_unweighted=new Chart(i).Bar(h),$("#chart_unweighted").click(function(e){var t,r;return t=$.chart_unweighted.getBarsAtEvent(e),r=t[0].label,showComments(r)})}):void 0}),showComments=function(e){var t,r,a,n,o;for(r=$.all_comments[e],$("#commentviewer").empty(),o=[],a=0,n=r.length;n>a;a++)t=r[a],o.push($("#commentviewer").append("<div class='comment'> <span class='badge'>"+t[0]+" points</span>&nbsp;<a target='_blank' href='"+t[5]+"'>"+t[4]+"</a><br />"+t[1].replace(new RegExp("(^|)("+e+")(|$)","ig"),'$1<span class="search-kw text-danger">$2</span>$3')+"<br /><small>["+t[2]+" replies |  <a target='_blank' href='"+t[3]+"'>permalink</a>]</small></div><hr />"));return o},getUrlParameter=function(e){var t,r,a,n;for(r=window.location.search.substring(1),n=r.split("&"),t=0;t<n.length;){if(a=n[t].split("="),a[0]===e)return decodeURIComponent(a[1].replace(/\+/g,"%20").replace("/",""));t++}};